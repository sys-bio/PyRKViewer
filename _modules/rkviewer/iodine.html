

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rkviewer.iodine &mdash; COYOTE or PyRKViewer 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> COYOTE or PyRKViewer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../QuickStart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PluginDevelopment.html">Plugin Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PluginReference.html">Plugin Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CoreDevelopment.html">Core Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Reference.html">Core Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">COYOTE or PyRKViewer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>rkviewer.iodine</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for rkviewer.iodine</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Iodine Network Object Model.</span>

<span class="sd">Original author:    RJ Zhou</span>
<span class="sd">&quot;Forked&quot; from:      https://github.com/zrj26/go-NOM</span>
<span class="sd">Adapted by:         Gary Geng</span>

<span class="sd">TODOs</span>
<span class="sd">    * Phase out errCode, or at least provide more detalis in error messages.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># from __future__ import annotations</span>
<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">from</span> <span class="nn">re</span> <span class="kn">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">X</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="kn">from</span> <span class="nn">marshmallow.decorators</span> <span class="kn">import</span> <span class="n">post_dump</span><span class="p">,</span> <span class="n">post_load</span><span class="p">,</span> <span class="n">pre_load</span>
<span class="kn">from</span> <span class="nn">marshmallow_polyfield</span> <span class="kn">import</span> <span class="n">PolyField</span>
<span class="kn">from</span> <span class="nn">numpy.lib.npyio</span> <span class="kn">import</span> <span class="n">recfromcsv</span>
<span class="kn">from</span> <span class="nn">.mvc</span> <span class="kn">import</span> <span class="p">(</span><span class="n">ModifierTipStyle</span><span class="p">,</span> <span class="n">IDNotFoundError</span><span class="p">,</span> <span class="n">IDRepeatError</span><span class="p">,</span> <span class="n">NodeNotFreeError</span><span class="p">,</span> <span class="n">NetIndexError</span><span class="p">,</span>
                  <span class="n">ReactionIndexError</span><span class="p">,</span> <span class="n">NodeIndexError</span><span class="p">,</span> <span class="n">CompartmentIndexError</span><span class="p">,</span> <span class="n">StoichError</span><span class="p">,</span>
                  <span class="n">StackEmptyError</span><span class="p">,</span> <span class="n">JSONError</span><span class="p">,</span> <span class="n">FileError</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.config</span> <span class="kn">import</span> <span class="n">ColorField</span><span class="p">,</span> <span class="n">Pixel</span><span class="p">,</span> <span class="n">Dim</span><span class="p">,</span> <span class="n">Dim2</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span> <span class="n">FontField</span><span class="p">,</span> <span class="n">get_theme</span>
<span class="kn">from</span> <span class="nn">.canvas.geometry</span> <span class="kn">import</span> <span class="n">Vec2</span>
<span class="kn">from</span> <span class="nn">.canvas.data</span> <span class="kn">import</span> <span class="n">CompositeShapeFactory</span><span class="p">,</span> <span class="n">PrimitiveFactory</span><span class="p">,</span> <span class="n">CirclePrim</span><span class="p">,</span> <span class="n">CompositeShape</span><span class="p">,</span> <span class="n">Primitive</span><span class="p">,</span> \
    <span class="n">RectanglePrim</span><span class="p">,</span> <span class="n">HexagonPrim</span><span class="p">,</span> <span class="n">LinePrim</span><span class="p">,</span> <span class="n">TrianglePrim</span><span class="p">,</span> <span class="n">Transform</span><span class="p">,</span> <span class="n">TextPrim</span><span class="p">,</span> <span class="n">ChoiceItem</span><span class="p">,</span>\
    <span class="n">FONT_FAMILY_CHOICES</span><span class="p">,</span> <span class="n">FONT_STYLE_CHOICES</span><span class="p">,</span> <span class="n">FONT_WEIGHT_CHOICES</span><span class="p">,</span> <span class="n">TEXT_ALIGNMENT_CHOICES</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">DefaultDict</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">MutableSet</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">cast</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">marshmallow</span> <span class="kn">import</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">validate</span><span class="p">,</span> <span class="n">missing</span> <span class="k">as</span> <span class="n">missing_</span><span class="p">,</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">pre_dump</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>


<span class="c1"># The current version of the network serialization schema.</span>
<span class="n">SERIAL_VERSION</span> <span class="o">=</span> <span class="s2">&quot;1.0.0&quot;</span>


<div class="viewcode-block" id="get_theme_fn"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.get_theme_fn">[docs]</a><span class="k">def</span> <span class="nf">get_theme_fn</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="n">get_theme</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">convert_color</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<span class="c1"># kwargs common to geometric shapes</span>
<span class="n">geometry_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;fill_color&#39;</span><span class="p">:</span> <span class="n">get_theme_fn</span><span class="p">(</span><span class="s1">&#39;node_fill&#39;</span><span class="p">),</span>
    <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">get_theme_fn</span><span class="p">(</span><span class="s1">&#39;node_border&#39;</span><span class="p">),</span>
    <span class="s1">&#39;border_width&#39;</span><span class="p">:</span> <span class="n">get_theme_fn</span><span class="p">(</span><span class="s1">&#39;node_border_width&#39;</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Default primitive factories</span>
<span class="n">rectFact</span> <span class="o">=</span> <span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">RectanglePrim</span><span class="p">,</span> <span class="o">**</span><span class="n">geometry_kwargs</span><span class="p">)</span>
<span class="n">circleFact</span> <span class="o">=</span> <span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">CirclePrim</span><span class="p">,</span> <span class="o">**</span><span class="n">geometry_kwargs</span><span class="p">)</span>
<span class="n">hexFact</span> <span class="o">=</span> <span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">HexagonPrim</span><span class="p">,</span> <span class="o">**</span><span class="n">geometry_kwargs</span><span class="p">)</span>
<span class="n">lineFact</span> <span class="o">=</span> <span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">LinePrim</span><span class="p">,</span> <span class="o">**</span><span class="n">geometry_kwargs</span><span class="p">)</span>
<span class="n">triangleFact</span> <span class="o">=</span> <span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">TrianglePrim</span><span class="p">,</span> <span class="o">**</span><span class="n">geometry_kwargs</span><span class="p">)</span>
<span class="n">textFact</span> <span class="o">=</span> <span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">TextPrim</span><span class="p">)</span>
<span class="n">singletonTrans</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">()</span>  <span class="c1"># fills the entire bounding box</span>

<span class="n">DEFAULT_SHAPE_FACTORY</span> <span class="o">=</span> <span class="n">CompositeShapeFactory</span><span class="p">([(</span><span class="n">rectFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">)],</span>
                        <span class="p">(</span><span class="n">textFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">),</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">)</span>
<span class="c1"># These are the default shape factories. They should never be modified by the user.</span>
<span class="n">shapeFactories</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DEFAULT_SHAPE_FACTORY</span><span class="p">,</span>
    <span class="n">CompositeShapeFactory</span><span class="p">([(</span><span class="n">circleFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">)],</span> <span class="p">(</span><span class="n">textFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">),</span> <span class="s1">&#39;circle&#39;</span><span class="p">),</span>
    <span class="n">CompositeShapeFactory</span><span class="p">([(</span><span class="n">hexFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">)],</span> <span class="p">(</span><span class="n">textFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">),</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">),</span>
    <span class="n">CompositeShapeFactory</span><span class="p">([(</span><span class="n">lineFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">)],</span> <span class="p">(</span><span class="n">textFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">),</span> <span class="s1">&#39;line&#39;</span><span class="p">),</span>
    <span class="n">CompositeShapeFactory</span><span class="p">([(</span><span class="n">triangleFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">)],</span> <span class="p">(</span><span class="n">textFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">),</span> <span class="s1">&#39;triangle&#39;</span><span class="p">),</span>
    <span class="n">CompositeShapeFactory</span><span class="p">([],</span> <span class="p">(</span><span class="n">textFact</span><span class="p">,</span> <span class="n">singletonTrans</span><span class="p">),</span> <span class="s1">&#39;text-only&#39;</span><span class="p">),</span>
    <span class="n">CompositeShapeFactory</span><span class="p">([(</span><span class="n">circleFact</span><span class="p">,</span> <span class="n">Transform</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">Vec2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))),</span>
                           <span class="p">(</span><span class="n">circleFact</span><span class="p">,</span> <span class="n">Transform</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">Vec2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">translation</span><span class="o">=</span><span class="n">Vec2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))),</span>
                           <span class="p">(</span><span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">RectanglePrim</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                                <span class="n">Transform</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">Vec2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">translation</span><span class="o">=</span><span class="n">Vec2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)))</span>
                           <span class="p">],</span>
        <span class="p">(</span><span class="n">PrimitiveFactory</span><span class="p">(</span><span class="n">TextPrim</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span> <span class="n">singletonTrans</span><span class="p">),</span> <span class="s1">&#39;demo combo&#39;</span><span class="p">),</span>
<span class="p">]</span>


<span class="c1"># TODO add lockedNode here too</span>
<div class="viewcode-block" id="TAbstractNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TAbstractNode">[docs]</a><span class="k">class</span> <span class="nc">TAbstractNode</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">rectSize</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">nodeLocked</span><span class="p">:</span> <span class="nb">bool</span></div>


<div class="viewcode-block" id="TNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TNode">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TNode</span><span class="p">(</span><span class="n">TAbstractNode</span><span class="p">):</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">rectSize</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">floating</span> <span class="p">:</span> <span class="nb">bool</span>  <span class="c1"># If false it means the node is a boundary node</span>
    <span class="n">nodeLocked</span><span class="p">:</span> <span class="nb">bool</span> <span class="c1">#if false it means the node can be moved</span>
    <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">shapei</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">shape</span><span class="p">:</span> <span class="n">CompositeShape</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">shapeFactories</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">produce</span><span class="p">())</span>
    <span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="TAliasNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TAliasNode">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TAliasNode</span><span class="p">(</span><span class="n">TAbstractNode</span><span class="p">):</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">rectSize</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">originalIdx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">nodeLocked</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></div>


<div class="viewcode-block" id="TNetwork"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TNetwork">[docs]</a><span class="k">class</span> <span class="nc">TNetwork</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Represents an entire reaction network.</span>

<span class="sd">    **NOTE IMPORTANT** whenever any change is made to the code that changes how the network is</span>
<span class="sd">    serialized/deserialized, one must bump the global variable SERIAL_VERSION to reflect that. See</span>
<span class="sd">    NetworkSchema::serialVersion for more information.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">nodes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">TAbstractNode</span><span class="p">]</span>
    <span class="n">reactions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;TReaction&#39;</span><span class="p">]</span>
    <span class="n">compartments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;TCompartment&#39;</span><span class="p">]</span>
    <span class="n">baseNodes</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>  <span class="c1">#: Set of node indices not in any compartment</span>
    <span class="n">srcMap</span><span class="p">:</span> <span class="n">DefaultDict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">MutableSet</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>  <span class="c1">#: Map nodes to reactions of which it is a source</span>
    <span class="n">destMap</span><span class="p">:</span> <span class="n">DefaultDict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">MutableSet</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>  <span class="c1">#: Map nodes to reactions of which it is a target</span>
    <span class="n">lastNodeIdx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">lastReactionIdx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">lastCompartmentIdx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">TAbstractNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">reactions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;TReaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">compartments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;TCompartment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="p">):</span>
        <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">reactions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reactions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">compartments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">compartments</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">reactions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span> <span class="o">=</span> <span class="n">compartments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseNodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">compi</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srcMap</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destMap</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="c1"># Initialize srcMap and destMap</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">src</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">dest</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastNodeIdx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastReactionIdx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">reactions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastCompartmentIdx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<div class="viewcode-block" id="TNetwork.addNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TNetwork.addNode">[docs]</a>    <span class="k">def</span> <span class="nf">addNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">TAbstractNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lastNodeIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseNodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastNodeIdx</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastNodeIdx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastNodeIdx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="TNetwork.addReaction"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TNetwork.addReaction">[docs]</a>    <span class="k">def</span> <span class="nf">addReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rea</span><span class="p">:</span> <span class="s1">&#39;TReaction&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lastReactionIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rea</span>

        <span class="c1"># update nodeToReactions</span>
        <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">rea</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">src</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastReactionIdx</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">rea</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">dest</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastReactionIdx</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastReactionIdx</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="TNetwork.addCompartment"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TNetwork.addCompartment">[docs]</a>    <span class="k">def</span> <span class="nf">addCompartment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp</span><span class="p">:</span> <span class="s1">&#39;TCompartment&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastCompartmentIdx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastCompartmentIdx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ind</span></div></div>


<div class="viewcode-block" id="TReaction"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TReaction">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TReaction</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">centerPos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vec2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rateLaw</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">reactants</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;TSpeciesNode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">products</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;TSpeciesNode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">fillColor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="n">thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span>
    <span class="n">centerHandlePos</span><span class="p">:</span> <span class="n">Vec2</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">()</span>
    <span class="n">bezierCurves</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># If false it means a straight line</span>
    <span class="n">modifiers</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>
    <span class="n">tipStyle</span><span class="p">:</span> <span class="n">ModifierTipStyle</span> <span class="o">=</span> <span class="n">ModifierTipStyle</span><span class="o">.</span><span class="n">CIRCLE</span></div>


<div class="viewcode-block" id="TSpeciesNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TSpeciesNode">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TSpeciesNode</span><span class="p">:</span>
    <span class="n">stoich</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">handlePos</span><span class="p">:</span> <span class="n">Vec2</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">()</span></div>


<div class="viewcode-block" id="TCompartment"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TCompartment">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TCompartment</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">rectSize</span><span class="p">:</span> <span class="n">Vec2</span>
    <span class="n">node_indices</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>
    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">fillColor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="n">outlineColor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="n">outlineThickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span></div>


<div class="viewcode-block" id="TStack"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TStack">[docs]</a><span class="k">class</span> <span class="nc">TStack</span><span class="p">:</span>
    <span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s1">&#39;TNetworkDict&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="TStack.isEmpty"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TStack.isEmpty">[docs]</a>    <span class="k">def</span> <span class="nf">isEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">==</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="TStack.push"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TStack.push">[docs]</a>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">netDict</span><span class="p">:</span> <span class="s1">&#39;TNetworkDict&#39;</span><span class="p">):</span>
        <span class="n">theSet</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">netDict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theSet</span><span class="p">)</span></div>

<div class="viewcode-block" id="TStack.pop"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TStack.pop">[docs]</a>    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="TNetworkDict"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TNetworkDict">[docs]</a><span class="k">class</span> <span class="nc">TNetworkDict</span><span class="p">(</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">TNetwork</span><span class="p">]):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastNetIndex</span> <span class="o">=</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="ErrorCode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.ErrorCode">[docs]</a><span class="k">class</span> <span class="nc">ErrorCode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">OK</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">OTHER</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ID_NOT_FOUND</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">ID_REPEAT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
    <span class="n">NODE_NOT_FREE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
    <span class="n">NETI_NOT_FOUND</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="n">REAI_NOT_FOUND</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
    <span class="n">NODEI_NOT_FOUND</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
    <span class="n">BAD_STOICH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
    <span class="n">STACK_EMPTY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
    <span class="n">JSON_ERROR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
    <span class="n">FILE_ERROR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span>
    <span class="n">OUT_OF_RANGE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
    <span class="n">COMPI_NOT_FOUND</span> <span class="o">=</span> <span class="o">-</span><span class="mi">13</span></div>


<span class="n">errorDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;other&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;id not found&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;id repeat&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;node is not free&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;net index not found&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;reaction index not found&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;node index not found&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;bad stoich: stoich has to be positive&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;undo/redo stack is empty&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;Json convert error&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;File error&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">12</span><span class="p">:</span> <span class="s2">&quot;Variable out of range&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">13</span><span class="p">:</span> <span class="s2">&quot;Compartment index not found&quot;</span><span class="p">,</span>
<span class="p">}</span>


<span class="n">ExceptionDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="n">IDNotFoundError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="n">IDRepeatError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="n">NodeNotFreeError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="n">NetIndexError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="n">ReactionIndexError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="n">NodeIndexError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">8</span><span class="p">:</span> <span class="n">StoichError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">9</span><span class="p">:</span> <span class="n">StackEmptyError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">10</span><span class="p">:</span> <span class="n">JSONError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">11</span><span class="p">:</span> <span class="n">FileError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">12</span><span class="p">:</span> <span class="ne">ValueError</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">13</span><span class="p">:</span> <span class="n">CompartmentIndexError</span><span class="p">,</span>
<span class="p">}</span>


<span class="n">fontFamilyDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;decorative&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;roman&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;script&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;swiss&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;modern&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">fontStyleDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;normal&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;italic&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">fontWeightDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;light&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;bold&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>


<span class="n">stackFlag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">errCode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># dict mapping from index to network</span>
<span class="n">networkDict</span><span class="p">:</span> <span class="n">TNetworkDict</span> <span class="o">=</span> <span class="n">TNetworkDict</span><span class="p">()</span>
<span class="n">undoStack</span><span class="p">:</span> <span class="n">TStack</span> <span class="o">=</span> <span class="n">TStack</span><span class="p">()</span>
<span class="n">redoStack</span><span class="p">:</span> <span class="n">TStack</span> <span class="o">=</span> <span class="n">TStack</span><span class="p">()</span>
<span class="n">lastNetIndex</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>


<div class="viewcode-block" id="getErrorCode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getErrorCode">[docs]</a><span class="k">def</span> <span class="nf">getErrorCode</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;get the error code of last function&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">errCode</span>
    <span class="k">return</span> <span class="n">errCode</span></div>


<div class="viewcode-block" id="undo"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.undo">[docs]</a><span class="k">def</span> <span class="nf">undo</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Undo ge back to last state</span>
<span class="sd">    errCode: -9: stack is empty</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">undoStack</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">redoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">networkDict</span><span class="p">)</span>
        <span class="n">networkDict</span> <span class="o">=</span> <span class="n">undoStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="redo"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.redo">[docs]</a><span class="k">def</span> <span class="nf">redo</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Redo redo</span>
<span class="sd">    errCode: -9: stack is empty</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="k">if</span> <span class="n">redoStack</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">networkDict</span><span class="p">)</span>
        <span class="n">networkDict</span> <span class="o">=</span> <span class="n">redoStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="startGroup"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.startGroup">[docs]</a><span class="k">def</span> <span class="nf">startGroup</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    StartGroup used at the start of a group operaction or secondary function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">redoStack</span> <span class="o">=</span> <span class="n">TStack</span><span class="p">()</span>
    <span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">networkDict</span><span class="p">)</span>
    <span class="n">stackFlag</span> <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="endGroup"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.endGroup">[docs]</a><span class="k">def</span> <span class="nf">endGroup</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    EndGroup used at the end of a group operaction or secondary function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span>
    <span class="n">stackFlag</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="newNetwork"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.newNetwork">[docs]</a><span class="k">def</span> <span class="nf">newNetwork</span><span class="p">(</span><span class="n">netID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    newNetwork Create a new network</span>
<span class="sd">    errCode -3: id repeat, 0 :ok</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span><span class="p">,</span> <span class="n">lastNetIndex</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">network</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">netID</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_pushUndoStack</span><span class="p">()</span>

        <span class="n">newNetwork</span> <span class="o">=</span> <span class="n">TNetwork</span><span class="p">(</span><span class="n">netID</span><span class="p">)</span>
        <span class="n">networkDict</span><span class="p">[</span><span class="n">lastNetIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNetwork</span>
        <span class="n">lastNetIndex</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="getNetworkIndex"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNetworkIndex">[docs]</a><span class="k">def</span> <span class="nf">getNetworkIndex</span><span class="p">(</span><span class="n">netID</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNetworkIndex</span>
<span class="sd">    return: -2: net id can&#39;t find</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">net</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">netID</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="n">i</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<span class="c1"># def saveNetworkAsJSON(neti: int, fileName: str):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     SaveNetworkAsJSON SaveNetworkAsJSON</span>
<span class="c1">#     errCode: -5: net index out of range</span>
<span class="c1">#     -10: &quot;Json convert error&quot;, -11: &quot;File error&quot;</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     global stackFlag, errCode, networkDict, undoStack, redoStack</span>
<span class="c1">#     errCode = 0</span>
<span class="c1">#     if neti not in networkDict:</span>
<span class="c1">#         errCode = -5</span>
<span class="c1">#         raise ExceptionDict[errCode](errorDict[errCode])</span>
<span class="c1">#     else:</span>
<span class="c1">#         data2 = json.dumps(networkDict[neti],</span>
<span class="c1">#                            sort_keys=True, indent=4, separators=(&#39;,&#39;, &#39;: &#39;))</span>
<span class="c1">#         print(data2)</span>


<span class="c1"># #ReadNetworkFromJSON ReadNetworkFromJSON</span>
<span class="c1"># #errCode -3: id repeat, 0 :ok</span>
<span class="c1"># #-10: &quot;Json convert error&quot;, -11: &quot;File error&quot;,</span>
<span class="c1"># def ReadNetworkFromJSON(filePath string) int :</span>
<span class="c1">#     errCode = 0</span>
<span class="c1">#     file, err1 = ioutil.ReadFile(filePath)</span>
<span class="c1">#     if err1 != nil :</span>
<span class="c1">#         errCode = -11</span>
<span class="c1">#         addErrorMessage(errCode, &quot;(\&quot;&quot; + filePath + &quot;\&quot;)&quot;, &quot;&quot;, &quot;&quot;)</span>
<span class="c1">#         return errCode</span>

<span class="c1">#     newNet = TNetwork{</span>
<span class="c1">#     err2 = json.Unmarshal([]byte(file), &amp;newNet)</span>
<span class="c1">#     if err2 != nil :</span>
<span class="c1">#         errCode = -10</span>
<span class="c1">#         addErrorMessage(errCode, &quot;(\&quot;&quot; + filePath + &quot;\&quot;)&quot;, &quot;&quot;, &quot;&quot;)</span>
<span class="c1">#         return errCode</span>

<span class="c1">#     for i = range networkDict :</span>
<span class="c1">#         if newNet.id == networkDict[i].id :</span>
<span class="c1">#             errCode = -3</span>
<span class="c1">#             addErrorMessage(errCode, (&quot;(\&quot;&quot; + filePath + &quot;\&quot;)&quot;), newNet.id, &quot;&quot;)</span>
<span class="c1">#             return errCode</span>


<span class="c1">#     if stackFlag :</span>
<span class="c1">#         redoStack = TundoStack{</span>
<span class="c1">#         undoStack.push(networkDict)</span>

<span class="c1">#     networkDict = append(networkDict, newNet)</span>
<span class="c1">#     # fmt.Println(networkDict)</span>
<span class="c1">#     return errCode</span>


<div class="viewcode-block" id="deleteNetwork"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.deleteNetwork">[docs]</a><span class="k">def</span> <span class="nf">deleteNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DeleteNetwork DeleteNetwork</span>
<span class="sd">    errCode: -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_pushUndoStack</span><span class="p">()</span>

        <span class="k">del</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span></div>


<div class="viewcode-block" id="clearNetworks"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.clearNetworks">[docs]</a><span class="k">def</span> <span class="nf">clearNetworks</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span><span class="p">,</span> <span class="n">lastNetIndex</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">networkDict</span> <span class="o">=</span> <span class="n">TNetworkDict</span><span class="p">()</span>
    <span class="n">lastNetIndex</span> <span class="o">=</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="getNumberOfNetworks"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNumberOfNetworks">[docs]</a><span class="k">def</span> <span class="nf">getNumberOfNetworks</span><span class="p">():</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">networkDict</span><span class="p">)</span></div>


<div class="viewcode-block" id="getNetworkID"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNetworkID">[docs]</a><span class="k">def</span> <span class="nf">getNetworkID</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GetNetworkID GetID of network</span>
<span class="sd">    errCode: -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">id</span></div>


<div class="viewcode-block" id="getListOfNetworks"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfNetworks">[docs]</a><span class="k">def</span> <span class="nf">getListOfNetworks</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">networkDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>


<span class="k">def</span> <span class="nf">_raiseError</span><span class="p">(</span><span class="n">eCode</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">errCode</span>
    <span class="k">assert</span> <span class="n">eCode</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="n">eCode</span>
    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">_addNetwork</span><span class="p">(</span><span class="n">network</span><span class="p">:</span> <span class="n">TNetwork</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Helper function that adds a network object.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">lastNetIndex</span>
    <span class="k">for</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">net</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">network</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
            <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>

    <span class="n">networkDict</span><span class="p">[</span><span class="n">lastNetIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">network</span>
    <span class="n">lastNetIndex</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">lastNetIndex</span> <span class="o">-</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TNetwork</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TAbstractNode</span><span class="p">:</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TNode</span><span class="p">:</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">):</span>
        <span class="c1"># get the original node</span>
        <span class="n">originalIdx</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">originalIdx</span>
        <span class="k">assert</span> <span class="n">originalIdx</span>  <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">originalIdx</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">node</span>


<span class="k">def</span> <span class="nf">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TReaction</span><span class="p">:</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TCompartment</span><span class="p">:</span>
    <span class="k">global</span> <span class="n">errCode</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">compi</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">13</span>
        <span class="k">raise</span> <span class="n">CompartmentIndexError</span><span class="p">(</span><span class="s1">&#39;Unknown index: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compi</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="p">[</span><span class="n">compi</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_pushUndoStack</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="k">if</span> <span class="n">stackFlag</span><span class="p">:</span>
        <span class="n">redoStack</span> <span class="o">=</span> <span class="n">TStack</span><span class="p">()</span>
        <span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">networkDict</span><span class="p">)</span>


<div class="viewcode-block" id="addNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.addNode">[docs]</a><span class="k">def</span> <span class="nf">addNode</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodeID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">floatingNode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nodeLocked</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AddNode adds a node to the network</span>
<span class="sd">    errCode - 3: id repeat, 0: ok</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">nodeID</span><span class="p">:</span>
            <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">w</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">h</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">newNode</span> <span class="o">=</span> <span class="n">TNode</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">lastNodeIdx</span><span class="p">,</span> <span class="n">nodeID</span><span class="p">,</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">floatingNode</span><span class="p">,</span> <span class="n">nodeLocked</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">addNode</span><span class="p">(</span><span class="n">newNode</span><span class="p">)</span></div>


<div class="viewcode-block" id="addAliasNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.addAliasNode">[docs]</a><span class="k">def</span> <span class="nf">addAliasNode</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">originalIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>

    <span class="c1"># make sure we can get it</span>
    <span class="n">original_node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">originalIdx</span><span class="p">)</span>

    <span class="n">_pushUndoStack</span><span class="p">()</span>

    <span class="c1"># Refer to the original node&#39;s index, whether &#39;original_index&#39; is a TNode or a TAliasNode</span>
    <span class="n">anode</span> <span class="o">=</span> <span class="n">TAliasNode</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">lastNodeIdx</span><span class="p">,</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">original_node</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                       <span class="n">nodeLocked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">anodei</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">addNode</span><span class="p">(</span><span class="n">anode</span><span class="p">)</span>
    <span class="n">setCompartmentOfNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">anodei</span><span class="p">,</span> <span class="n">original_node</span><span class="o">.</span><span class="n">compi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">anodei</span></div>


<div class="viewcode-block" id="aliasForReaction"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.aliasForReaction">[docs]</a><span class="k">def</span> <span class="nf">aliasForReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create an alias for nodei, and replace each instance of nodei in reai with the alias</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># ensure that the original node exists</span>
    <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>

    <span class="n">aliasi</span> <span class="o">=</span> <span class="n">addAliasNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

    <span class="n">reaction</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>

    <span class="c1"># update reactants and srcMap</span>
    <span class="k">if</span> <span class="n">nodei</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
        <span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">aliasi</span><span class="p">]</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
        <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reai</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">aliasi</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">reai</span><span class="p">)</span>

    <span class="c1"># update products and destMap</span>
    <span class="k">if</span> <span class="n">nodei</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
        <span class="n">reaction</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">aliasi</span><span class="p">]</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">reaction</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
        <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reai</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">aliasi</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">reai</span><span class="p">)</span></div>


<div class="viewcode-block" id="getNodeIndex"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeIndex">[docs]</a><span class="k">def</span> <span class="nf">getNodeIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodeID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GetNodeIndex get node index by id</span>
<span class="sd">    errCode: -2: node id not found,</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    return: &gt;=0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">nodeID</span><span class="p">:</span>
                <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="n">i</span>

    <span class="k">assert</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="deleteNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.deleteNode">[docs]</a><span class="k">def</span> <span class="nf">deleteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DeleteNode deletes the node with index. Returns whether there was a node with the given index,</span>
<span class="sd">    i.e. whether a node was deleted.</span>

<span class="sd">    This does not throw an error due to the possibility of someone deleting nodes in a loop, in</span>
<span class="sd">    which case an original copy may be deleted before its alias, and so when the alias is reached,</span>
<span class="sd">    it no longer exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">deleteHelper</span><span class="p">(</span><span class="n">net</span><span class="p">:</span> <span class="n">TNetwork</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">TAbstractNode</span><span class="p">,</span> <span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">is_alias</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="c1"># to delete an alias, remove it from the compartment</span>
        <span class="c1"># modify the reactions that it is in, so that previous references now point to the original</span>
        <span class="c1"># node. Also modify the modifiers to do the same</span>

        <span class="k">if</span> <span class="n">is_alias</span><span class="p">:</span>
            <span class="c1"># swap all occurrences of alias with the original node, since we&#39;re deleting the alias</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">)</span>
            <span class="n">srcReactions</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
            <span class="n">destReactions</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>

            <span class="c1"># put the original node in the reaction in the place of the alias node</span>
            <span class="k">for</span> <span class="n">reai</span> <span class="ow">in</span> <span class="n">srcReactions</span><span class="p">:</span>
                <span class="n">rxn</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">originalIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rxn</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
                <span class="c1"># I&#39;m not sure what should happen if both a node and its alias are reactants of</span>
                <span class="c1"># the same reaction. Originally I thought of adding up the stoich of the deleted</span>
                <span class="c1"># alias to that of the original node, but frankly this is such a nonsensical case</span>
                <span class="c1"># that I think doing so would be making it unncessarily complicated.</span>
                <span class="c1"># So now I&#39;m just deleting it and doing nothing</span>
                <span class="c1"># if original_species:</span>
                <span class="c1">#     new_species = rxn.reactants[node.originalIdx]</span>
                <span class="c1">#     new_species.stoich += original_species.stoich</span>
                <span class="c1">#     new_species.handlePos = original_species.handlePos</span>
                <span class="k">del</span> <span class="n">rxn</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">reai</span> <span class="ow">in</span> <span class="n">destReactions</span><span class="p">:</span>
                <span class="n">rxn</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span>
                <span class="c1"># see above for explanation</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">originalIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rxn</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
                <span class="c1"># if original_species:</span>
                <span class="c1">#     new_species = rxn.products[node.originalIdx]</span>
                <span class="c1">#     new_species.stoich += original_species.stoich</span>
                <span class="c1">#     new_species.handlePos = original_species.handlePos</span>
                <span class="k">del</span> <span class="n">rxn</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>

            <span class="c1"># update srcMap and destMap</span>
            <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">originalIdx</span><span class="p">]</span> <span class="o">|=</span> <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
            <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">originalIdx</span><span class="p">]</span> <span class="o">|=</span> <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>

            <span class="c1"># replace occurrences in modifiers</span>
            <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">nodei</span> <span class="ow">in</span> <span class="n">rxn</span><span class="o">.</span><span class="n">modifiers</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">modifiers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">modifiers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">originalIdx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># for now, disallow removing concrete nodes that are part of a reaction</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>

            <span class="c1"># remove self from modifiers list</span>
            <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">modifiers</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>

        <span class="c1"># remove from compartment</span>
        <span class="n">compi</span> <span class="o">=</span> <span class="n">getCompartmentOfNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">compi</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">net</span><span class="o">.</span><span class="n">baseNodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="p">[</span><span class="n">compi</span><span class="p">]</span><span class="o">.</span><span class="n">node_indices</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>

        <span class="c1"># remove from &#39;nodes&#39;</span>
        <span class="k">del</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span>


    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NodeIndexError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># validate that node is not part of a reaction</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">_pushUndoStack</span><span class="p">()</span>

    <span class="n">is_alias</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_alias</span><span class="p">:</span>
        <span class="n">deleteHelper</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># delete all the aliases of node if node is an original node</span>
        <span class="n">alias_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cast</span><span class="p">(</span><span class="n">TAliasNode</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">originalIdx</span> <span class="o">==</span> <span class="n">nodei</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">alias_idx</span> <span class="ow">in</span> <span class="n">alias_indices</span><span class="p">:</span>
            <span class="n">deleteHelper</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">alias_idx</span><span class="p">],</span> <span class="n">neti</span><span class="p">,</span> <span class="n">alias_idx</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># delete original node</span>
        <span class="n">deleteHelper</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="clearNetwork"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.clearNetwork">[docs]</a><span class="k">def</span> <span class="nf">clearNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ClearNetwork clear all nodes and reactions in this network</span>
<span class="sd">    errCode: -5:  net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_pushUndoStack</span><span class="p">()</span>
        <span class="c1"># networkDict[neti].nodes.clear()</span>
        <span class="c1"># networkDict[neti].reactions.clear()</span>
        <span class="c1"># networkDict[neti].compartments.clear()</span>
        <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span> <span class="o">=</span> <span class="n">TNetwork</span><span class="p">(</span><span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>


<div class="viewcode-block" id="getNumberOfNodes"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNumberOfNodes">[docs]</a><span class="k">def</span> <span class="nf">getNumberOfNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GetNumberOfNodes get the number of nodes in the current network</span>
<span class="sd">    num: &gt;= -5:  net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span></div>


<div class="viewcode-block" id="getNodeCenter"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeCenter">[docs]</a><span class="k">def</span> <span class="nf">getNodeCenter</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GetNodeCenter Get the X and  Y coordinate of the Center of node</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getNodeID"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeID">[docs]</a><span class="k">def</span> <span class="nf">getNodeID</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GetNodeID Get the id of the node</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>

<div class="viewcode-block" id="getNodeConcentration"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeConcentration">[docs]</a><span class="k">def</span> <span class="nf">getNodeConcentration</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GetNodeConcentration - get the concentration of the node</span>
<span class="sd">    errcode:</span>
<span class="sd">        -7: node index out of range</span>
<span class="sd">        -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">concentration</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getOriginalIndex"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getOriginalIndex">[docs]</a><span class="k">def</span> <span class="nf">getOriginalIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Return -1 if the node is an original, or if this is an alias, return the original index.&#39;&#39;&#39;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TNode</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">originalIdx</span></div>


<div class="viewcode-block" id="IsFloatingNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.IsFloatingNode">[docs]</a><span class="k">def</span> <span class="nf">IsFloatingNode</span><span class="p">(</span><span class="n">neti</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span> <span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">floating</span></div>


<div class="viewcode-block" id="IsBoundaryNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.IsBoundaryNode">[docs]</a><span class="k">def</span> <span class="nf">IsBoundaryNode</span><span class="p">(</span><span class="n">neti</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span> <span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="n">IsFloatingNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span></div>


<div class="viewcode-block" id="IsNodeLocked"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.IsNodeLocked">[docs]</a><span class="k">def</span> <span class="nf">IsNodeLocked</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">nodeLocked</span></div>


<div class="viewcode-block" id="getListOfNodeIDs"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfNodeIDs">[docs]</a><span class="k">def</span> <span class="nf">getListOfNodeIDs</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)]</span></div>


<div class="viewcode-block" id="getListOfNodeIndices"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfNodeIndices">[docs]</a><span class="k">def</span> <span class="nf">getListOfNodeIndices</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>


<div class="viewcode-block" id="getListOfReactionIndices"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfReactionIndices">[docs]</a><span class="k">def</span> <span class="nf">getListOfReactionIndices</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>


<div class="viewcode-block" id="getListOfCompartmentIndices"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfCompartmentIndices">[docs]</a><span class="k">def</span> <span class="nf">getListOfCompartmentIndices</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span><span class="o">.</span><span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>


<div class="viewcode-block" id="getSrcReactions"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getSrcReactions">[docs]</a><span class="k">def</span> <span class="nf">getSrcReactions</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">])</span></div>


<div class="viewcode-block" id="getDestReactions"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getDestReactions">[docs]</a><span class="k">def</span> <span class="nf">getDestReactions</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">nodei</span><span class="p">])</span></div>


<div class="viewcode-block" id="getNodeCoordinateAndSize"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeCoordinateAndSize">[docs]</a><span class="k">def</span> <span class="nf">getNodeCoordinateAndSize</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNodeCoordinateAndSize get the x,y,w,h of the node</span>
<span class="sd">    errCode:-7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">W</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">H</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="colorToRGB"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.colorToRGB">[docs]</a><span class="k">def</span> <span class="nf">colorToRGB</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="n">Color</span><span class="p">):</span>
    <span class="n">color1</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">r</span>
    <span class="n">color1</span> <span class="o">=</span> <span class="p">(</span><span class="n">color1</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">color</span><span class="o">.</span><span class="n">g</span>
    <span class="n">color1</span> <span class="o">=</span> <span class="p">(</span><span class="n">color1</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">color</span><span class="o">.</span><span class="n">b</span>
    <span class="k">return</span> <span class="n">color1</span></div>


<div class="viewcode-block" id="getNodeFillColor"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeFillColor">[docs]</a><span class="k">def</span> <span class="nf">getNodeFillColor</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the &#39;fill_color&#39; property of the first primitive in the given node&#39;s composite shape, if</span>
<span class="sd">    there is such a primitive. Otherwise, return None.</span>

<span class="sd">    This function exists for backwards-compatibility and convenience reasons.</span>

<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;fill_color&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;fill_color&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
    <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="getNodeFillColorRGB"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeFillColorRGB">[docs]</a><span class="k">def</span> <span class="nf">getNodeFillColorRGB</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    See getNodeFillColor(), except only returns the RGB values</span>

<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">getNodeFillColor</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">colorToRGB</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></div>


<div class="viewcode-block" id="getNodeFillColorAlpha"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeFillColorAlpha">[docs]</a><span class="k">def</span> <span class="nf">getNodeFillColorAlpha</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNodeFillColorAlpha getNodeFillColor alpha value(float)</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">getNodeFillColor</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">color</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span></div>


<div class="viewcode-block" id="getNodeBorderColor"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeBorderColor">[docs]</a><span class="k">def</span> <span class="nf">getNodeBorderColor</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNodeBorderColor rgba tulple format, rgb range int[0,255] alpha range float[0,1]</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;border_color&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
    <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="getNodeBorderColorRGB"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeBorderColorRGB">[docs]</a><span class="k">def</span> <span class="nf">getNodeBorderColorRGB</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNodeBorderColorRGB getNodeBorderColor rgb int format</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">getNodeBorderColor</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">colorToRGB</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></div>


<div class="viewcode-block" id="getNodeBorderColorAlpha"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeBorderColorAlpha">[docs]</a><span class="k">def</span> <span class="nf">getNodeBorderColorAlpha</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNodeBorderColorAlpha getNodeBorderColor alpha value(float)</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">getNodeBorderColor</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">color</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span></div>


<div class="viewcode-block" id="getNodeBorderWidth"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeBorderWidth">[docs]</a><span class="k">def</span> <span class="nf">getNodeBorderWidth</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNodeBorderWidth</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;border_width&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;border_width&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="setNodeID"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeID">[docs]</a><span class="k">def</span> <span class="nf">setNodeID</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">newID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeID set the id of a node</span>
<span class="sd">    errCode -3: id repeat</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -7: node index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">n</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">newID</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">TNode</span><span class="p">))):</span>
                <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_pushUndoStack</span><span class="p">()</span>
                <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">newID</span>
                <span class="k">return</span>
    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>

<div class="viewcode-block" id="setNodeConcentration"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeConcentration">[docs]</a><span class="k">def</span> <span class="nf">setNodeConcentration</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">newConc</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeConcentration - sets the concentration of a node</span>
<span class="sd">    errCode -5: net index out of range</span>
<span class="sd">            -7: node index out of range</span>
<span class="sd">            -12: variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">newConc</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">newConc</span>
            <span class="k">return</span>
    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>

<div class="viewcode-block" id="setNodeCoordinate"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeCoordinate">[docs]</a><span class="k">def</span> <span class="nf">setNodeCoordinate</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">allowNegativeCoordinates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeCoordinate setNodeCoordinate</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">allowNegativeCoordinates</span><span class="p">:</span>
        <span class="n">lowerLimit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1E12</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lowerLimit</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">lowerLimit</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">lowerLimit</span><span class="p">:</span>
            <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
        <span class="c1"># only move if node is locked</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">nodeLocked</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">n</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setNodeSize"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeSize">[docs]</a><span class="k">def</span> <span class="nf">setNodeSize</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeSize setNodeSize</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">w</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">h</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">rectSize</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setNodeFloatingStatus"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeFloatingStatus">[docs]</a><span class="k">def</span> <span class="nf">setNodeFloatingStatus</span> <span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">floatingStatus</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeFloatingStatus setNodeFloatingStatus</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">floating</span> <span class="o">=</span> <span class="n">floatingStatus</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>

<div class="viewcode-block" id="setNodeLockedStatus"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeLockedStatus">[docs]</a><span class="k">def</span> <span class="nf">setNodeLockedStatus</span> <span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lockedNode</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeLockedStatus setNodeLockedStatus</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">nodeLocked</span> <span class="o">=</span> <span class="n">lockedNode</span>
            <span class="k">return</span></div>


<div class="viewcode-block" id="setNodeFillColorRGB"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeFillColorRGB">[docs]</a><span class="k">def</span> <span class="nf">setNodeFillColorRGB</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeFillColorRGB setNodeFillColorRGB</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;fill_color&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="n">old_color</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;fill_color&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old_color</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;fill_color&#39;</span><span class="p">,</span> <span class="n">old_color</span><span class="o">.</span><span class="n">swapped</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="setNodeFillColorAlpha"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeFillColorAlpha">[docs]</a><span class="k">def</span> <span class="nf">setNodeFillColorAlpha</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeFillColorAlpha setNodeFillColorAlpha</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;fill_color&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="n">a_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>
            <span class="n">old_color</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;fill_color&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old_color</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;fill_color&#39;</span><span class="p">,</span> <span class="n">old_color</span><span class="o">.</span><span class="n">swapped</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a_int</span><span class="p">))</span></div>


<div class="viewcode-block" id="setNodeBorderColorRGB"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeBorderColorRGB">[docs]</a><span class="k">def</span> <span class="nf">setNodeBorderColorRGB</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeBorderColorRGB setNodeBorderColorRGB</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;border_color&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="n">old_color</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old_color</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">,</span> <span class="n">old_color</span><span class="o">.</span><span class="n">swapped</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="setNodeBorderColorAlpha"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeBorderColorAlpha">[docs]</a><span class="k">def</span> <span class="nf">setNodeBorderColorAlpha</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeBorderColorAlpha setNodeBorderColorAlpha, alpha is a float between 0 and 1</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;border_color&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="n">a_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>
            <span class="n">old_color</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old_color</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">,</span> <span class="n">old_color</span><span class="o">.</span><span class="n">swapped</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a_int</span><span class="p">))</span></div>


<div class="viewcode-block" id="setNodeBorderWidth"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeBorderWidth">[docs]</a><span class="k">def</span> <span class="nf">setNodeBorderWidth</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setNodeBorderWidth setNodeBorderWidth</span>
<span class="sd">    errCode: -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prim</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;border_width&#39;</span> <span class="ow">in</span> <span class="n">prim</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="s1">&#39;border_width&#39;</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span></div>


<div class="viewcode-block" id="createReaction"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.createReaction">[docs]</a><span class="k">def</span> <span class="nf">createReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reaID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sources</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">targets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    createReaction create an empty reacton</span>
<span class="sd">    errCode: -3: id repeat</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Reaction &#39;</span><span class="si">{}</span><span class="s2">&#39; has no reactants or it has no products&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reaID</span><span class="p">))</span>

    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="c1"># duplicate ID?</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">r</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">reaID</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># ensure nodes exist</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">nodei</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">):</span>
            <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">nodei</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">nodei</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">):</span>
            <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">targets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Reaction source node set and target node set cannot be identical.&#39;</span><span class="p">)</span>
        <span class="n">_pushUndoStack</span><span class="p">()</span>
        <span class="n">newReact</span> <span class="o">=</span> <span class="n">TReaction</span><span class="p">(</span><span class="n">reaID</span><span class="p">)</span>

        <span class="c1"># Add src/target nodes</span>
        <span class="k">for</span> <span class="n">srcNodeIdx</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
            <span class="n">newReact</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">srcNodeIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">TSpeciesNode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># default stoich to 1</span>
        <span class="k">for</span> <span class="n">destNodeIdx</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
            <span class="n">newReact</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">destNodeIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">TSpeciesNode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># default stoich to 1</span>

        <span class="n">net</span><span class="o">.</span><span class="n">addReaction</span><span class="p">(</span><span class="n">newReact</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionIndex"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionIndex">[docs]</a><span class="k">def</span> <span class="nf">getReactionIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reaID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionIndex get reaction index by id</span>
<span class="sd">    return: -2: id can&#39;t find, &gt;=0: ok</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">reaID</span><span class="p">:</span>
                <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="n">i</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="deleteReaction"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.deleteReaction">[docs]</a><span class="k">def</span> <span class="nf">deleteReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    deleteReaction delete the reaction with index</span>
<span class="sd">    errCode:  -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="p">[</span><span class="n">src</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reai</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="p">[</span><span class="n">dest</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reai</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="clearReactions"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.clearReactions">[docs]</a><span class="k">def</span> <span class="nf">clearReactions</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    clearReactions clear all reactions in this network</span>
<span class="sd">    errCode: -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>

    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_pushUndoStack</span><span class="p">()</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">net</span><span class="o">.</span><span class="n">srcMap</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">net</span><span class="o">.</span><span class="n">destMap</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


<div class="viewcode-block" id="getNumberOfReactions"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNumberOfReactions">[docs]</a><span class="k">def</span> <span class="nf">getNumberOfReactions</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNumberOfReactions get the number of reactions in the current Reactionset</span>
<span class="sd">    return: &gt;=0: ok, -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">errCode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></div>


<div class="viewcode-block" id="getReactionID"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionID">[docs]</a><span class="k">def</span> <span class="nf">getReactionID</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionID get the id of Reaction</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getListOfReactionIDs"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfReactionIDs">[docs]</a><span class="k">def</span> <span class="nf">getListOfReactionIDs</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span></div>


<div class="viewcode-block" id="getReactionRateLaw"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionRateLaw">[docs]</a><span class="k">def</span> <span class="nf">getReactionRateLaw</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionRateLaw get the ratelaw of Reaction</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">rateLaw</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionCenterPos"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionCenterPos">[docs]</a><span class="k">def</span> <span class="nf">getReactionCenterPos</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionCenterPos get the center position of the Reaction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">centerPos</span></div>


<div class="viewcode-block" id="getReactionFillColor"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionFillColor">[docs]</a><span class="k">def</span> <span class="nf">getReactionFillColor</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionFillColor rgba tulple format, rgb range int[0,255] alpha range float[0,1]</span>
<span class="sd">    errCode:  -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionFillColorRGB"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionFillColorRGB">[docs]</a><span class="k">def</span> <span class="nf">getReactionFillColorRGB</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionFillColorRGB getReactionFillColorRGB</span>
<span class="sd">    errCode:  -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color1</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">r</span>
            <span class="n">color1</span> <span class="o">=</span> <span class="p">(</span><span class="n">color1</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">g</span>
            <span class="n">color1</span> <span class="o">=</span> <span class="p">(</span><span class="n">color1</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">b</span>
            <span class="k">return</span> <span class="n">color1</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionFillColorAlpha"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionFillColorAlpha">[docs]</a><span class="k">def</span> <span class="nf">getReactionFillColorAlpha</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionFillColorAlpha getReactionFillColorAlpha</span>
<span class="sd">    errCode:  -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alpha1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>
            <span class="k">return</span> <span class="n">alpha1</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionLineThickness"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionLineThickness">[docs]</a><span class="k">def</span> <span class="nf">getReactionLineThickness</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionLineThickness getReactionLineThickness</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">thickness</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionCenterHandlePosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionCenterHandlePosition">[docs]</a><span class="k">def</span> <span class="nf">getReactionCenterHandlePosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionCenterHandlePosition getReactionCenterHandlePosition</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">centerHandlePos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">centerHandlePos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionSrcNodeStoich"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionSrcNodeStoich">[docs]</a><span class="k">def</span> <span class="nf">getReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srcNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionSrcNodeStoich get the SrcNode stoichiometry of Reaction</span>
<span class="sd">    errCode: -6: reaction index out of range,</span>
<span class="sd">    -5: net index out of range, -7: node index not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a reactant node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">srcNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">srcNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">stoich</span>
    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionDestNodeStoich"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionDestNodeStoich">[docs]</a><span class="k">def</span> <span class="nf">getReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">destNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionDestNodeStoich get the DestNode stoichiometry of Reaction</span>
<span class="sd">    return: positive float : ok, -6: reaction index out of range, -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a product node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">destNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">destNodeIdx</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">stoich</span>
    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionSrcNodeHandlePosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionSrcNodeHandlePosition">[docs]</a><span class="k">def</span> <span class="nf">getReactionSrcNodeHandlePosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srcNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionSrcNodeHandlePosition get the SrcNode HandlePosition of Reaction</span>
<span class="sd">    errCode: -6: reaction index out of range,</span>
<span class="sd">    -5: net index out of range, -7: node index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a reactant node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">srcNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">srcNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">handlePos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">srcNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">handlePos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getReactionDestNodeHandlePosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionDestNodeHandlePosition">[docs]</a><span class="k">def</span> <span class="nf">getReactionDestNodeHandlePosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">destNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getReactionDestNodeStoich get the DestNode HandlePosition of Reaction</span>
<span class="sd">    return: positive float : ok, -6: reaction index out of range, -7: node index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a product node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">destNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">destNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">handlePos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">destNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">handlePos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getNumberOfSrcNodes"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNumberOfSrcNodes">[docs]</a><span class="k">def</span> <span class="nf">getNumberOfSrcNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNumberOfSrcNodes get the SrcNode length of Reaction</span>
<span class="sd">    return: non-negative int: ok, -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">)</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getNumberOfDestNodes"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNumberOfDestNodes">[docs]</a><span class="k">def</span> <span class="nf">getNumberOfDestNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getNumberOfDestNodes get the DestNode length of Reaction</span>
<span class="sd">    return: non-negative int: ok, -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">)</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getListOfReactionSrcNodes"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfReactionSrcNodes">[docs]</a><span class="k">def</span> <span class="nf">getListOfReactionSrcNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getListOfReactionSrcNodes getListOfReactionSrcNodes in alphabetical order</span>
<span class="sd">    return: non-empty slice : ok, -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reactions</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">list1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
                <span class="n">list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">list1</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">list1</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getListOfReactionDestNodes"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfReactionDestNodes">[docs]</a><span class="k">def</span> <span class="nf">getListOfReactionDestNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    getListOfReactionDestNodes getListOfReactionDestNodes in alphabetical order</span>
<span class="sd">    return: non-empty slice : ok, -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">list1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
                <span class="n">list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">list1</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">list1</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="getListOfReactionSrcStoich"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfReactionSrcStoich">[docs]</a><span class="k">def</span> <span class="nf">getListOfReactionSrcStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">getListOfReactionSrcNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="n">srcStoichList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">srcNodeID</span> <span class="ow">in</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">srcStoichList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">getReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">srcNodeID</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">srcStoichList</span></div>


<div class="viewcode-block" id="getListOfReactionDestStoich"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfReactionDestStoich">[docs]</a><span class="k">def</span> <span class="nf">getListOfReactionDestStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">getListOfReactionDestNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="n">destStoichList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">destNodeID</span> <span class="ow">in</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">destStoichList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">getReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">destNodeID</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">destStoichList</span></div>


<div class="viewcode-block" id="printReactionInfo"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.printReactionInfo">[docs]</a><span class="k">def</span> <span class="nf">printReactionInfo</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id:&quot;</span><span class="p">,</span> <span class="n">getReactionID</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rateLaw:&quot;</span><span class="p">,</span> <span class="n">getReactionRateLaw</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SrcNodes:&quot;</span><span class="p">,</span> <span class="n">getListOfReactionSrcNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DestNodes:&quot;</span><span class="p">,</span> <span class="n">getListOfReactionDestNodes</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SrcNodeStoichs:&quot;</span><span class="p">,</span> <span class="n">getListOfReactionSrcStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DestNodeStoichs:&quot;</span><span class="p">,</span> <span class="n">getListOfReactionDestStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span></div>


<span class="c1"># def deleteSrcNode(neti: int, reai: int, srcNodeIdx: int):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     deleteSrcNode delete src nodes by id(ID).</span>
<span class="c1">#     errCode: -6: reaction index out of range,</span>
<span class="c1">#     -5: net index out of range</span>
<span class="c1">#     -2: id not found</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     global stackFlag, errCode, networkDict, undoStack, redoStack</span>
<span class="c1">#     errCode = 0</span>
<span class="c1">#     if neti not in networkDict:</span>
<span class="c1">#         errCode = -5</span>
<span class="c1">#     else:</span>
<span class="c1">#         r = networkDict[neti].reactions</span>
<span class="c1">#         if reai not in networkDict[neti].reactions:</span>
<span class="c1">#             errCode = -6</span>
<span class="c1">#         else:</span>
<span class="c1">#             rea = r[reai]</span>
<span class="c1">#             if srcNodeIdx not in rea.reactants:</span>
<span class="c1">#                 errCode = -2</span>
<span class="c1">#             else:</span>
<span class="c1">#                 _pushUndoStack()</span>
<span class="c1">#                 del rea.reactants[srcNodeIdx]</span>
<span class="c1">#                 networkDict[neti].reactions[reai] = rea</span>
<span class="c1">#                 return</span>

<span class="c1">#     raise ExceptionDict[errCode](errorDict[errCode])</span>


<span class="c1"># def deleteDestNode(neti: int, reai: int, destNodeIdx: int):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     deleteDestNode delete all dest nodes by id</span>
<span class="c1">#     errCode: -6: reaction index out of range,</span>
<span class="c1">#     -5: net index out of range</span>
<span class="c1">#     -2: id not found</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     global stackFlag, errCode, networkDict, undoStack, redoStack</span>
<span class="c1">#     errCode = 0</span>
<span class="c1">#     if neti not in networkDict:</span>
<span class="c1">#         errCode = -5</span>
<span class="c1">#     else:</span>
<span class="c1">#         r = networkDict[neti].reactions</span>
<span class="c1">#         if reai not in networkDict[neti].reactions:</span>
<span class="c1">#             errCode = -6</span>
<span class="c1">#         else:</span>
<span class="c1">#             rea = r[reai]</span>
<span class="c1">#             if destNodeIdx not in rea.products:</span>
<span class="c1">#                 errCode = -2</span>
<span class="c1">#             else:</span>
<span class="c1">#                 _pushUndoStack()</span>
<span class="c1">#                 del rea.products[destNodeIdx]</span>
<span class="c1">#                 return</span>

<span class="c1">#     raise ExceptionDict[errCode](errorDict[errCode])</span>


<div class="viewcode-block" id="setReactionID"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionID">[docs]</a><span class="k">def</span> <span class="nf">setReactionID</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">newID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionID edit id of reaction</span>
<span class="sd">    errCode: 0:ok, -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -3: id repeat</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reactions</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">r</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">newID</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
                <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_pushUndoStack</span><span class="p">()</span>
                <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">newID</span>
                <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setRateLaw"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setRateLaw">[docs]</a><span class="k">def</span> <span class="nf">setRateLaw</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setRateLaw edit rate law of reaction</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">rateLaw</span> <span class="o">=</span> <span class="n">rateLaw</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionCenterPos"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionCenterPos">[docs]</a><span class="k">def</span> <span class="nf">setReactionCenterPos</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">centerPos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vec2</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionCenterPos set the center position of the Reaction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">centerPos</span> <span class="o">=</span> <span class="n">centerPos</span></div>


<div class="viewcode-block" id="setReactionSrcNodeStoich"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionSrcNodeStoich">[docs]</a><span class="k">def</span> <span class="nf">setReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srcNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">newStoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionSrcNodeStoich edit Stoich by Reaction srcNodeID</span>
<span class="sd">    errCode: -6: reaction index not found,</span>
<span class="sd">    -5: net index not found</span>
<span class="sd">    -7: node index not found,</span>
<span class="sd">    -8: wrong stoich</span>
<span class="sd">    raises ValueError if given node index not a dest node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a reactant node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">srcNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">newStoich</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">srcNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">stoich</span> <span class="o">=</span> <span class="n">newStoich</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionDestNodeStoich"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionDestNodeStoich">[docs]</a><span class="k">def</span> <span class="nf">setReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">destNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">newStoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionDestNodeStoich edit Stoich by Reaction destNodeID</span>
<span class="sd">    errCode: -6: reaction index out of range,</span>
<span class="sd">    -5: net index out of range,</span>
<span class="sd">    -7: node index not found,</span>
<span class="sd">    -8: wrong stoich</span>
<span class="sd">    raises ValueError if given node index not a dest node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a product node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">destNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">newStoich</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">destNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">stoich</span> <span class="o">=</span> <span class="n">newStoich</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionSrcNodeHandlePosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionSrcNodeHandlePosition">[docs]</a><span class="k">def</span> <span class="nf">setReactionSrcNodeHandlePosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srcNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">handlePosX</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">handlePosY</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionSrcNodeHandlePosition edit HandlePosition by Reaction srcNodeID</span>
<span class="sd">    errCode: -6: reaction index out of range,</span>
<span class="sd">    -5: net index out of range, -7: node index not found</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">srcNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a reactant node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">srcNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">srcNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">handlePos</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">(</span>
                <span class="n">handlePosX</span><span class="p">,</span> <span class="n">handlePosY</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionDestNodeHandlePosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionDestNodeHandlePosition">[docs]</a><span class="k">def</span> <span class="nf">setReactionDestNodeHandlePosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">destNodeIdx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">handlePosX</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">handlePosY</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionDestNodeHandlePosition edit HandlePosition by Reaction destNodeID</span>
<span class="sd">    errCode: -6: reaction index out of range,</span>
<span class="sd">    -5: net index out of range, -2: id not found</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">destNodeIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The given node index &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a product node of &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="n">destNodeIdx</span><span class="p">,</span> <span class="n">reai</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">destNodeIdx</span><span class="p">]</span><span class="o">.</span><span class="n">handlePos</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">(</span>
                <span class="n">handlePosX</span><span class="p">,</span> <span class="n">handlePosY</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionFillColorRGB"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionFillColorRGB">[docs]</a><span class="k">def</span> <span class="nf">setReactionFillColorRGB</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">R</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">G</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionFillColorRGB setReactionFillColorRGB</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">R</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">R</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">or</span> <span class="n">G</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">G</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">or</span> <span class="n">B</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">swapped</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionFillColorAlpha"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionFillColorAlpha">[docs]</a><span class="k">def</span> <span class="nf">setReactionFillColorAlpha</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionFillColorAlpha setReactionFillColorAlpha</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">A1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>
            <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">fillColor</span><span class="o">.</span><span class="n">swapped</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">A1</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionLineThickness"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionLineThickness">[docs]</a><span class="k">def</span> <span class="nf">setReactionLineThickness</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">thickness</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionLineThickness setReactionLineThickness</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">thickness</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="bezier_curves"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.bezier_curves">[docs]</a><span class="k">def</span> <span class="nf">bezier_curves</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">bezierCurves</span></div>

<div class="viewcode-block" id="setReactionBezierCurves"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionBezierCurves">[docs]</a><span class="k">def</span> <span class="nf">setReactionBezierCurves</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">bezierCurves</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionBezierCurves setReactionBezierCurves</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">r</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">bezierCurves</span> <span class="o">=</span> <span class="n">bezierCurves</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>


<div class="viewcode-block" id="setReactionModifiers"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionModifiers">[docs]</a><span class="k">def</span> <span class="nf">setReactionModifiers</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">modifiers</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">modifiers</span><span class="p">))</span></div>


<div class="viewcode-block" id="getReactionModifiers"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getReactionModifiers">[docs]</a><span class="k">def</span> <span class="nf">getReactionModifiers</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">modifiers</span><span class="p">)</span></div>


<div class="viewcode-block" id="setModifierTipStyle"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setModifierTipStyle">[docs]</a><span class="k">def</span> <span class="nf">setModifierTipStyle</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">tipStyle</span><span class="p">:</span> <span class="n">ModifierTipStyle</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">tipStyle</span> <span class="o">=</span> <span class="n">tipStyle</span></div>


<div class="viewcode-block" id="getModifierTipStyle"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getModifierTipStyle">[docs]</a><span class="k">def</span> <span class="nf">getModifierTipStyle</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModifierTipStyle</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_getReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">tipStyle</span></div>


<div class="viewcode-block" id="setReactionCenterHandlePosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setReactionCenterHandlePosition">[docs]</a><span class="k">def</span> <span class="nf">setReactionCenterHandlePosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reai</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">centerHandlePosX</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">centerHandlePosY</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    setReactionCenterHandlePosition setReactionCenterHandlePosition</span>
<span class="sd">    errCode: -6: reaction index out of range</span>
<span class="sd">    -5: net index out of range</span>
<span class="sd">    -12: Variable out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">neti</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reai</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pushUndoStack</span><span class="p">()</span>
            <span class="n">networkDict</span><span class="p">[</span><span class="n">neti</span><span class="p">]</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reai</span><span class="p">]</span><span class="o">.</span><span class="n">centerHandlePos</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">(</span>
                <span class="n">centerHandlePosX</span><span class="p">,</span> <span class="n">centerHandlePosY</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>

<div class="viewcode-block" id="setParameter"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setParameter">[docs]</a><span class="k">def</span> <span class="nf">setParameter</span><span class="p">(</span><span class="n">netid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">param_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add or change network parameter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">netid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># TODO verify param values</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">netid</span><span class="p">)</span>
        <span class="n">_pushUndoStack</span><span class="p">()</span>
        <span class="n">n</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">param_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_value</span>
        <span class="k">return</span>
    
    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errorDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>

<div class="viewcode-block" id="removeParameter"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.removeParameter">[docs]</a><span class="k">def</span> <span class="nf">removeParameter</span><span class="p">(</span><span class="n">netid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">param_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove a network parameter. No change if param_id is not a parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">netid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="n">errCode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">netid</span><span class="p">)</span>
        <span class="n">_pushUndoStack</span><span class="p">()</span>
        <span class="n">n</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param_id</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">](</span><span class="n">errDict</span><span class="p">[</span><span class="n">errCode</span><span class="p">])</span></div>

<div class="viewcode-block" id="getParameters"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getParameters">[docs]</a><span class="k">def</span> <span class="nf">getParameters</span><span class="p">(</span><span class="n">netid</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">netid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExceptionDict</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">](</span><span class="n">errDict</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">netid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">parameters</span></div>
    

<div class="viewcode-block" id="addCompartment"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.addCompartment">[docs]</a><span class="k">def</span> <span class="nf">addCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a compartment and add to canvas. Return the index of the compartment added.</span>

<span class="sd">    Args:</span>
<span class="sd">        neti: network index.</span>
<span class="sd">        compID: ID of the compartment.</span>
<span class="sd">        x: x coordinate of top-left corner</span>
<span class="sd">        y: y coordinate of top-left corner</span>
<span class="sd">        w: width</span>
<span class="sd">        h: height</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">h</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">TCompartment</span><span class="p">(</span><span class="n">compID</span><span class="p">,</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">compID</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">net</span><span class="o">.</span><span class="n">addCompartment</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span></div>


<div class="viewcode-block" id="deleteCompartment"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.deleteCompartment">[docs]</a><span class="k">def</span> <span class="nf">deleteCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete the compartment of the given index in the given network.&quot;&quot;&quot;</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">compi</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">)</span>

    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="c1"># Put all nodes in compartment in base compartment (-1)</span>
    <span class="k">for</span> <span class="n">nodei</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="p">[</span><span class="n">compi</span><span class="p">]</span><span class="o">.</span><span class="n">node_indices</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">compi</span> <span class="o">==</span> <span class="n">compi</span>
        <span class="c1"># move to base compartment</span>
        <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nodei</span><span class="p">]</span><span class="o">.</span><span class="n">compi</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">net</span><span class="o">.</span><span class="n">baseNodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="p">[</span><span class="n">compi</span><span class="p">]</span></div>


<div class="viewcode-block" id="getListOfCompartments"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfCompartments">[docs]</a><span class="k">def</span> <span class="nf">getListOfCompartments</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span><span class="o">.</span><span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>


<div class="viewcode-block" id="getNodesInCompartment"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodesInCompartment">[docs]</a><span class="k">def</span> <span class="nf">getNodesInCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return the list of node indices in the given compartment.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">compi</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span><span class="o">.</span><span class="n">baseNodes</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">node_indices</span><span class="p">)</span>  <span class="c1"># Make copy in the process</span></div>


<div class="viewcode-block" id="getCompartmentOfNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentOfNode">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentOfNode</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the compartment index that the given node is in, or -1 if it is not in any.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">compi</span></div>


<div class="viewcode-block" id="setCompartmentOfNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentOfNode">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentOfNode</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the compartment of the node, or remove it from any compartment if -1 is given.&quot;&quot;&quot;</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>

    <span class="n">node</span> <span class="o">=</span> <span class="n">_getNodeOrAlias</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">compi</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">compartments</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">compi</span><span class="p">]</span><span class="o">.</span><span class="n">node_indices</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">baseNodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">compi</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">newComp</span> <span class="o">=</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span>
        <span class="n">newComp</span><span class="o">.</span><span class="n">node_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">baseNodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>

    <span class="n">node</span><span class="o">.</span><span class="n">compi</span> <span class="o">=</span> <span class="n">compi</span></div>


<div class="viewcode-block" id="setCompartmentPosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentPosition">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentPosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span>
    <span class="n">comp</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="getCompartmentPosition"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentPosition">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentPosition</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">comp</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="setCompartmentSize"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentSize">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentSize</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">h</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_raiseError</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span>
    <span class="n">comp</span><span class="o">.</span><span class="n">rectSize</span> <span class="o">=</span> <span class="n">Vec2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="getCompartmentSize"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentSize">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentSize</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">comp</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="setCompartmentVolume"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentVolume">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentVolume</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span></div>


<div class="viewcode-block" id="getCompartmentVolume"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentVolume">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentVolume</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">volume</span></div>


<div class="viewcode-block" id="setCompartmentID"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentID">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentID</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span></div>


<div class="viewcode-block" id="getCompartmentID"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentID">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentID</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">id</span></div>


<span class="c1"># TODO note that this returns a Color instead of tuples of numbers. Should change the node &amp;</span>
<span class="c1"># reaction color functions to do the same.</span>
<div class="viewcode-block" id="setCompartmentFillColor"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentFillColor">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentFillColor</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Color</span><span class="p">):</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">fillColor</span> <span class="o">=</span> <span class="n">color</span></div>


<div class="viewcode-block" id="getCompartmentFillColor"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentFillColor">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentFillColor</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Color</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">fillColor</span></div>


<div class="viewcode-block" id="setCompartmentOutlineColor"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentOutlineColor">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentOutlineColor</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Color</span><span class="p">):</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">outlineColor</span> <span class="o">=</span> <span class="n">color</span></div>


<div class="viewcode-block" id="getCompartmentOutlineColor"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentOutlineColor">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentOutlineColor</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Color</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">outlineColor</span></div>


<div class="viewcode-block" id="setCompartmentOutlineThickness"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setCompartmentOutlineThickness">[docs]</a><span class="k">def</span> <span class="nf">setCompartmentOutlineThickness</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">thickness</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">_pushUndoStack</span><span class="p">()</span>
    <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">outlineThickness</span> <span class="o">=</span> <span class="n">thickness</span></div>


<div class="viewcode-block" id="getCompartmentOutlineThickness"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompartmentOutlineThickness">[docs]</a><span class="k">def</span> <span class="nf">getCompartmentOutlineThickness</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">compi</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">_getCompartment</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">compi</span><span class="p">)</span><span class="o">.</span><span class="n">outlineThickness</span></div>


<div class="viewcode-block" id="createUniUni"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.createUniUni">[docs]</a><span class="k">def</span> <span class="nf">createUniUni</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reaID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">srci</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">desti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srcStoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">destStoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">startGroup</span><span class="p">()</span>
    <span class="n">createReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">,</span> <span class="p">[</span><span class="n">srci</span><span class="p">],</span> <span class="p">[</span><span class="n">desti</span><span class="p">])</span>
    <span class="n">reai</span> <span class="o">=</span> <span class="n">getReactionIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">)</span>

    <span class="n">setReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">srci</span><span class="p">,</span> <span class="n">srcStoich</span><span class="p">)</span>
    <span class="n">setReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">desti</span><span class="p">,</span> <span class="n">destStoich</span><span class="p">)</span>
    <span class="n">setRateLaw</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">)</span>
    <span class="n">endGroup</span><span class="p">()</span></div>


<span class="c1"># TODO allow modification of this list later</span>
<span class="c1"># TODO make note that neti is useless here. Probably just remove the argument later</span>
<span class="c1"># Also need to change getCompositeShapeAt</span>
<div class="viewcode-block" id="getListOfCompositeShapes"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getListOfCompositeShapes">[docs]</a><span class="k">def</span> <span class="nf">getListOfCompositeShapes</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">produce</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">shapeFactories</span><span class="p">]</span></div>


<div class="viewcode-block" id="getCompositeShapeAt"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getCompositeShapeAt">[docs]</a><span class="k">def</span> <span class="nf">getCompositeShapeAt</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">shapei</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">shapeFactories</span><span class="p">[</span><span class="n">shapei</span><span class="p">]</span><span class="o">.</span><span class="n">produce</span><span class="p">()</span></div>


<div class="viewcode-block" id="getNodeShape"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeShape">[docs]</a><span class="k">def</span> <span class="nf">getNodeShape</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompositeShape</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span></div>


<div class="viewcode-block" id="getNodeShapeIndex"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.getNodeShapeIndex">[docs]</a><span class="k">def</span> <span class="nf">getNodeShapeIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span><span class="o">.</span><span class="n">shapei</span></div>


<div class="viewcode-block" id="setNodeShapeIndex"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodeShapeIndex">[docs]</a><span class="k">def</span> <span class="nf">setNodeShapeIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">shapei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">preserve_common_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;If preserve_common_fields is True, then preserve common field values such as fill_color,</span>
<span class="sd">    if applicable.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="n">node</span><span class="o">.</span><span class="n">shapei</span> <span class="o">=</span> <span class="n">shapei</span>
    <span class="n">shp</span> <span class="o">=</span> <span class="n">shapeFactories</span><span class="p">[</span><span class="n">shapei</span><span class="p">]</span><span class="o">.</span><span class="n">produce</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">preserve_common_fields</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">items</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">prim</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">):</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_color</span>
            <span class="n">borderc</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">border_color</span>
            <span class="n">borderw</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">border_width</span>
            <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">shp</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">setNodePrimitiveProperty</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="s2">&quot;fill_color&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="p">)</span>
            <span class="n">setNodePrimitiveProperty</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="s2">&quot;border_color&quot;</span><span class="p">,</span> <span class="n">borderc</span><span class="p">)</span>
            <span class="n">setNodePrimitiveProperty</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="s2">&quot;border_width&quot;</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">borderw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">node</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shp</span></div>


<div class="viewcode-block" id="setNodePrimitiveProperty"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.setNodePrimitiveProperty">[docs]</a><span class="k">def</span> <span class="nf">setNodePrimitiveProperty</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodei</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prim_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prop_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Set an individual property of a node&#39;s primitive.</span>

<span class="sd">    Args:</span>
<span class="sd">        neti:       The network index</span>
<span class="sd">        nodei:      The node index</span>
<span class="sd">        prim_index: The index of the primitive, in the node&#39;s shape. If -1, then update the text</span>
<span class="sd">                    primitive instead.</span>
<span class="sd">        prop_name:  The name of the primitive&#39;s property.</span>
<span class="sd">        prop_value: The value of the primitives&#39;s property</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">_getConcreteNode</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">nodei</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">prim_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="ow">or</span> <span class="n">prim_index</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Primitive index out of range for the shape of node </span><span class="si">{}</span><span class="s1"> in network </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nodei</span><span class="p">,</span> <span class="n">neti</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">prim_index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">primitive</span><span class="p">,</span> <span class="n">_transform</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">text_item</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">primitive</span><span class="p">,</span> <span class="n">_transform</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">prim_index</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">primitive</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`</span><span class="si">{}</span><span class="s1">` is not a property of primitive `</span><span class="si">{}</span><span class="s1">`&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">prop_name</span><span class="p">,</span> <span class="n">primitive</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">primitive</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span>
    <span class="c1"># ensure that the assigned type is correct</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop_value</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Could not set primitive property `</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s1">` of node </span><span class="si">{</span><span class="n">nodei</span><span class="si">}</span><span class="s1"> at &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;primitive index </span><span class="si">{</span><span class="n">prim_index</span><span class="si">}</span><span class="s1">. Expected object of type `</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">`; got &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{</span><span class="n">prop_value</span><span class="si">}</span><span class="s1">`(`</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">prop_value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">`) instead. Note: the primitive &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;is of type `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">primitive</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">`.&#39;</span><span class="p">)</span>

    <span class="c1"># This is not very safe, but this is very simple to implement, so it shall be like this for now</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">primitive</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">prop_value</span><span class="p">)</span></div>



<div class="viewcode-block" id="CreateUniBi"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CreateUniBi">[docs]</a><span class="k">def</span> <span class="nf">CreateUniBi</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reaID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">srci</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dest1i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dest2i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srcStoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dest1Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dest2Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">startGroup</span><span class="p">()</span>
    <span class="n">createReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">,</span> <span class="p">[</span><span class="n">srci</span><span class="p">],</span> <span class="p">[</span><span class="n">dest1i</span><span class="p">,</span> <span class="n">dest2i</span><span class="p">])</span>
    <span class="n">reai</span> <span class="o">=</span> <span class="n">getReactionIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">)</span>

    <span class="n">setReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">srci</span><span class="p">,</span> <span class="n">srcStoich</span><span class="p">)</span>
    <span class="n">setReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">dest1i</span><span class="p">,</span> <span class="n">dest1Stoich</span><span class="p">)</span>
    <span class="n">setReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">dest2i</span><span class="p">,</span> <span class="n">dest2Stoich</span><span class="p">)</span>
    <span class="n">setRateLaw</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">)</span>
    <span class="n">endGroup</span><span class="p">()</span></div>


<div class="viewcode-block" id="CreateBiUni"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CreateBiUni">[docs]</a><span class="k">def</span> <span class="nf">CreateBiUni</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reaID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">src1i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">src2i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">desti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">src1Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">src2Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">destStoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">startGroup</span><span class="p">()</span>
    <span class="n">createReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">,</span> <span class="p">[</span><span class="n">src1i</span><span class="p">,</span> <span class="n">src2i</span><span class="p">],</span> <span class="p">[</span><span class="n">desti</span><span class="p">])</span>
    <span class="n">reai</span> <span class="o">=</span> <span class="n">getReactionIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">)</span>

    <span class="n">setReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">src1i</span><span class="p">,</span> <span class="n">src1Stoich</span><span class="p">)</span>
    <span class="n">setReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">src2i</span><span class="p">,</span> <span class="n">src2Stoich</span><span class="p">)</span>
    <span class="n">setReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">desti</span><span class="p">,</span> <span class="n">destStoich</span><span class="p">)</span>
    <span class="n">setRateLaw</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">)</span>
    <span class="n">endGroup</span><span class="p">()</span></div>


<div class="viewcode-block" id="CreateBiBi"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CreateBiBi">[docs]</a><span class="k">def</span> <span class="nf">CreateBiBi</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reaID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">src1i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">src2i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dest1i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dest2i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">src1Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">src2Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dest1Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dest2Stoich</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">startGroup</span><span class="p">()</span>
    <span class="n">createReaction</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">,</span> <span class="p">[</span><span class="n">src1i</span><span class="p">,</span> <span class="n">src2i</span><span class="p">],</span> <span class="p">[</span><span class="n">dest1i</span><span class="p">,</span> <span class="n">dest2i</span><span class="p">])</span>
    <span class="n">reai</span> <span class="o">=</span> <span class="n">getReactionIndex</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reaID</span><span class="p">)</span>

    <span class="n">setReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">src1i</span><span class="p">,</span> <span class="n">src1Stoich</span><span class="p">)</span>
    <span class="n">setReactionSrcNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">src2i</span><span class="p">,</span> <span class="n">src2Stoich</span><span class="p">)</span>
    <span class="n">setReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">dest1i</span><span class="p">,</span> <span class="n">dest1Stoich</span><span class="p">)</span>
    <span class="n">setReactionDestNodeStoich</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">dest2i</span><span class="p">,</span> <span class="n">dest2Stoich</span><span class="p">)</span>
    <span class="n">setRateLaw</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="n">reai</span><span class="p">,</span> <span class="n">rateLaw</span><span class="p">)</span>
    <span class="n">endGroup</span><span class="p">()</span></div>


<div class="viewcode-block" id="reset"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.reset">[docs]</a><span class="k">def</span> <span class="nf">reset</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">stackFlag</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">networkDict</span><span class="p">,</span> <span class="n">undoStack</span><span class="p">,</span> <span class="n">redoStack</span><span class="p">,</span> <span class="n">lastNetIndex</span>
    <span class="n">stackFlag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">errCode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">networkDict</span> <span class="o">=</span> <span class="n">TNetworkDict</span><span class="p">()</span>
    <span class="n">undoStack</span> <span class="o">=</span> <span class="n">TStack</span><span class="p">()</span>
    <span class="n">redoStack</span> <span class="o">=</span> <span class="n">TStack</span><span class="p">()</span>
    <span class="n">lastNetIndex</span> <span class="o">=</span> <span class="mi">0</span></div>


<span class="sd">&#39;&#39;&#39;Code for serialization/deserialization.&#39;&#39;&#39;</span>


<div class="viewcode-block" id="EnumField"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.EnumField">[docs]</a><span class="k">class</span> <span class="nc">EnumField</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enum_class</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">enum_class</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The enum class given to EnumField must have string values!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enum_class</span> <span class="o">=</span> <span class="n">enum_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_field</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="o">.</span><span class="n">OneOf</span><span class="p">(</span><span class="n">choices</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">entry</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">_deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_field</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">enum_class</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">entry</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Not supposed to reach here&quot;</span></div>

<div class="viewcode-block" id="ChoiceField"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.ChoiceField">[docs]</a><span class="k">class</span> <span class="nc">ChoiceField</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choice_list</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choice_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">ChoiceItem</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;not choice item&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choice_list</span> <span class="o">=</span> <span class="n">choice_list</span>

    <span class="k">def</span> <span class="nf">_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="n">choice</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">choice</span><span class="o">.</span><span class="n">text</span>

    <span class="k">def</span> <span class="nf">_deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">choice</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">choice</span><span class="o">.</span><span class="n">value</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;No choice found&quot;</span></div>

<div class="viewcode-block" id="FontSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.FontSchema">[docs]</a><span class="k">class</span> <span class="nc">FontSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="c1"># TODO use this after implemented</span>
    <span class="n">pointSize</span> <span class="o">=</span> <span class="n">Pixel</span><span class="p">()</span>
    <span class="n">family</span> <span class="o">=</span> <span class="nb">str</span>  <span class="c1"># TODO change to enum</span>
    <span class="n">style</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">weight</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">Color</span></div>

<div class="viewcode-block" id="TransformSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TransformSchema">[docs]</a><span class="k">class</span> <span class="nc">TransformSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="n">translation</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>

<div class="viewcode-block" id="TransformSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TransformSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Transform</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PrimitiveSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.PrimitiveSchema">[docs]</a><span class="k">class</span> <span class="nc">PrimitiveSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">fill_color</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">border_color</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">border_width</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span></div>


<div class="viewcode-block" id="RectangleSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.RectangleSchema">[docs]</a><span class="k">class</span> <span class="nc">RectangleSchema</span><span class="p">(</span><span class="n">PrimitiveSchema</span><span class="p">):</span>
    <span class="n">corner_radius</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span>

<div class="viewcode-block" id="RectangleSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.RectangleSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RectanglePrim</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">RectanglePrim</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CircleSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CircleSchema">[docs]</a><span class="k">class</span> <span class="nc">CircleSchema</span><span class="p">(</span><span class="n">PrimitiveSchema</span><span class="p">):</span>
<div class="viewcode-block" id="CircleSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CircleSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CirclePrim</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">CirclePrim</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PolygonSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.PolygonSchema">[docs]</a><span class="k">class</span> <span class="nc">PolygonSchema</span><span class="p">(</span><span class="n">PrimitiveSchema</span><span class="p">):</span>
    <span class="c1">#name = fields.Str()</span>
    <span class="n">fill_color</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">border_color</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">border_width</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span>
    <span class="n">corner_radius</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span></div>

<div class="viewcode-block" id="LineSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.LineSchema">[docs]</a><span class="k">class</span> <span class="nc">LineSchema</span><span class="p">(</span><span class="n">PrimitiveSchema</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(([</span><span class="n">Dim2</span><span class="p">()]</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<div class="viewcode-block" id="LineSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.LineSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinePrim</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">LinePrim</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TriangleSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TriangleSchema">[docs]</a><span class="k">class</span> <span class="nc">TriangleSchema</span><span class="p">(</span><span class="n">PolygonSchema</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(((</span><span class="n">Dim2</span><span class="p">(),)</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<div class="viewcode-block" id="TriangleSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TriangleSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrianglePrim</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">TrianglePrim</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="HexagonSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.HexagonSchema">[docs]</a><span class="k">class</span> <span class="nc">HexagonSchema</span><span class="p">(</span><span class="n">PolygonSchema</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Tuple</span><span class="p">((</span><span class="n">Dim2</span><span class="p">(),)</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>
<div class="viewcode-block" id="HexagonSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.HexagonSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HexagonPrim</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">HexagonPrim</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="primitive_dump"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.primitive_dump">[docs]</a><span class="k">def</span> <span class="nf">primitive_dump</span><span class="p">(</span><span class="n">base_obj</span><span class="p">,</span> <span class="n">parent_obj</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">RectanglePrim</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">RectangleSchema</span><span class="p">,</span>
        <span class="n">CirclePrim</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CircleSchema</span><span class="p">,</span>
        <span class="n">LinePrim</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">LineSchema</span><span class="p">,</span>
        <span class="n">TrianglePrim</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">TriangleSchema</span><span class="p">,</span>
        <span class="n">HexagonPrim</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">HexagonSchema</span>

    <span class="p">}[</span><span class="n">base_obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]()</span>
    <span class="k">return</span> <span class="n">ret</span></div>


<span class="n">primitive_schemas</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rectangle&#39;</span><span class="p">:</span><span class="n">RectangleSchema</span><span class="p">(),</span>
                     <span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="n">CircleSchema</span><span class="p">(),</span>
                     <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="n">TriangleSchema</span><span class="p">(),</span>
                     <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="n">LineSchema</span><span class="p">(),</span>
                     <span class="s1">&#39;hexagon&#39;</span><span class="p">:</span> <span class="n">HexagonSchema</span><span class="p">()}</span>
<div class="viewcode-block" id="primitive_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.primitive_load">[docs]</a><span class="k">def</span> <span class="nf">primitive_load</span><span class="p">(</span><span class="n">base_dict</span><span class="p">,</span> <span class="n">parent_dict</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">primitive_schemas</span><span class="p">[</span><span class="n">base_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span></div>


<span class="n">primitiveField</span> <span class="o">=</span> <span class="n">PolyField</span><span class="p">(</span>
    <span class="n">serialization_schema_selector</span><span class="o">=</span><span class="n">primitive_dump</span><span class="p">,</span>
    <span class="n">deserialization_schema_selector</span><span class="o">=</span><span class="n">primitive_load</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<div class="viewcode-block" id="TextSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TextSchema">[docs]</a><span class="k">class</span> <span class="nc">TextSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="c1">#name = fields.Str()</span>
    <span class="n">bg_color</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">font_color</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">font_size</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">()</span>
    <span class="n">font_family</span> <span class="o">=</span> <span class="n">ChoiceField</span><span class="p">(</span><span class="n">FONT_FAMILY_CHOICES</span><span class="p">)</span>
    <span class="n">font_style</span> <span class="o">=</span> <span class="n">ChoiceField</span><span class="p">(</span><span class="n">FONT_STYLE_CHOICES</span><span class="p">)</span>
    <span class="n">font_weight</span> <span class="o">=</span> <span class="n">ChoiceField</span><span class="p">(</span><span class="n">FONT_WEIGHT_CHOICES</span><span class="p">)</span>
    <span class="n">alignment</span> <span class="o">=</span> <span class="n">ChoiceField</span><span class="p">(</span><span class="n">TEXT_ALIGNMENT_CHOICES</span><span class="p">)</span>

<div class="viewcode-block" id="TextSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.TextSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TextPrim</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TextPrim</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="CompositeShapeSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CompositeShapeSchema">[docs]</a><span class="k">class</span> <span class="nc">CompositeShapeSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">text_item</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Tuple</span><span class="p">((</span><span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">TextSchema</span><span class="p">),</span> <span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">TransformSchema</span><span class="p">)))</span>
    <span class="n">items</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Tuple</span><span class="p">((</span><span class="n">primitiveField</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">TransformSchema</span><span class="p">))))</span>

<div class="viewcode-block" id="CompositeShapeSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CompositeShapeSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompositeShape</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">CompositeShape</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="AbstractNodeSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.AbstractNodeSchema">[docs]</a><span class="k">class</span> <span class="nc">AbstractNodeSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">()</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">position</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>
    <span class="n">rectSize</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>
    <span class="n">nodeLocked</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Bool</span><span class="p">()</span>

<div class="viewcode-block" id="AbstractNodeSchema.post_dump"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.AbstractNodeSchema.post_dump">[docs]</a>    <span class="nd">@post_dump</span>
    <span class="k">def</span> <span class="nf">post_dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<div class="viewcode-block" id="NodeSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.NodeSchema">[docs]</a><span class="k">class</span> <span class="nc">NodeSchema</span><span class="p">(</span><span class="n">AbstractNodeSchema</span><span class="p">):</span>
    <span class="n">floating</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Bool</span><span class="p">()</span>
    <span class="n">compi</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="n">missing</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">CompositeShapeSchema</span><span class="p">)</span>

<div class="viewcode-block" id="NodeSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.NodeSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TNode</span><span class="p">:</span>
        <span class="n">shape_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
        <span class="c1"># get shape index manually</span>
        <span class="c1"># If this fails, then somebody modified the shape name</span>
        <span class="n">shapei</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">shapeFactories</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">shape_name</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;shapei&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shapei</span>
        <span class="k">return</span> <span class="n">TNode</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AliasSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.AliasSchema">[docs]</a><span class="k">class</span> <span class="nc">AliasSchema</span><span class="p">(</span><span class="n">AbstractNodeSchema</span><span class="p">):</span>
    <span class="n">originalIdx</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">()</span>

<div class="viewcode-block" id="AliasSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.AliasSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">TAliasNode</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SpeciesNode"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.SpeciesNode">[docs]</a><span class="k">class</span> <span class="nc">SpeciesNode</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a species in a reaction.&quot;&quot;&quot;</span>
    <span class="n">stoich</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">()</span>
    <span class="n">handlePos</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>

<div class="viewcode-block" id="SpeciesNode.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.SpeciesNode.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TSpeciesNode</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TSpeciesNode</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ReactionSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.ReactionSchema">[docs]</a><span class="k">class</span> <span class="nc">ReactionSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">centerPos</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">(</span><span class="n">missing</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">rateLaw</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">reactants</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">(),</span> <span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">SpeciesNode</span><span class="p">))</span>
    <span class="n">products</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">(),</span> <span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">SpeciesNode</span><span class="p">))</span>
    <span class="n">fillColor</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">thickness</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span>
    <span class="n">centerHandlePos</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>
    <span class="n">bezierCurves</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Bool</span><span class="p">()</span>
    <span class="n">modifiers</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">())</span>
    <span class="n">tipStyle</span> <span class="o">=</span> <span class="n">EnumField</span><span class="p">(</span><span class="n">ModifierTipStyle</span><span class="p">)</span>

<div class="viewcode-block" id="ReactionSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.ReactionSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TReaction</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;modifiers&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;modifiers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;modifiers&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">TReaction</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="CompartmentSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CompartmentSchema">[docs]</a><span class="k">class</span> <span class="nc">CompartmentSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">position</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>
    <span class="n">rectSize</span> <span class="o">=</span> <span class="n">Dim2</span><span class="p">()</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">())</span>
    <span class="n">volume</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span>
    <span class="n">fillColor</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">outlineColor</span> <span class="o">=</span> <span class="n">ColorField</span><span class="p">()</span>
    <span class="n">outlineThickness</span> <span class="o">=</span> <span class="n">Dim</span><span class="p">()</span>

<div class="viewcode-block" id="CompartmentSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.CompartmentSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TCompartment</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TCompartment</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="node_or_alias_dump"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.node_or_alias_dump">[docs]</a><span class="k">def</span> <span class="nf">node_or_alias_dump</span><span class="p">(</span><span class="n">base_obj</span><span class="p">,</span> <span class="n">parent_obj</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span>  <span class="p">{</span>
        <span class="n">TNode</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">NodeSchema</span><span class="p">,</span>
        <span class="n">TAliasNode</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">AliasSchema</span><span class="p">,</span>
    <span class="p">}[</span><span class="n">base_obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]()</span>
    <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="node_or_alias_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.node_or_alias_load">[docs]</a><span class="k">def</span> <span class="nf">node_or_alias_load</span><span class="p">(</span><span class="n">base_dict</span><span class="p">,</span> <span class="n">parent_dict</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;originalIdx&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">NodeSchema</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">AliasSchema</span><span class="p">()</span></div>


<span class="n">nodeOrAliasField</span> <span class="o">=</span> <span class="n">PolyField</span><span class="p">(</span>
    <span class="n">serialization_schema_selector</span><span class="o">=</span><span class="n">node_or_alias_dump</span><span class="p">,</span>
    <span class="n">deserialization_schema_selector</span><span class="o">=</span><span class="n">node_or_alias_load</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<div class="viewcode-block" id="NetworkSchema"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.NetworkSchema">[docs]</a><span class="k">class</span> <span class="nc">NetworkSchema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Str</span><span class="p">()</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Mapping</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">(),</span> <span class="n">nodeOrAliasField</span><span class="p">)</span>
    <span class="n">reactions</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Mapping</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">(),</span> <span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">ReactionSchema</span><span class="p">))</span>
    <span class="n">compartments</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Mapping</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">Int</span><span class="p">(),</span> <span class="n">fields</span><span class="o">.</span><span class="n">Nested</span><span class="p">(</span><span class="n">CompartmentSchema</span><span class="p">))</span>

<div class="viewcode-block" id="NetworkSchema.pre_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.NetworkSchema.pre_load">[docs]</a>    <span class="nd">@pre_load</span>
    <span class="k">def</span> <span class="nf">pre_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># load serialization version</span>
        <span class="c1"># this records the version of the serialization. Whenever the serialization scheme is changed,</span>
        <span class="c1"># we update the version number, so that if a user is trying to load a network with an</span>
        <span class="c1"># older serialization version than the current application (or vice versa), we can either fail</span>
        <span class="c1"># to try to do some conversion.</span>
        <span class="n">serial_version</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serialVersion&#39;</span><span class="p">,</span> <span class="s1">&#39;pre-release&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">serial_version</span> <span class="o">!=</span> <span class="n">SERIAL_VERSION</span><span class="p">:</span>
            <span class="c1"># we have a mismatch</span>
            <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;Warning: loaded network has serial version &#39;</span><span class="si">{}</span><span class="s2">&#39;, which does not match that of &quot;</span>
                   <span class="s2">&quot;the application: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">serial_version</span><span class="p">,</span> <span class="n">SERIAL_VERSION</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;serialVersion&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;serialVersion&#39;</span><span class="p">]</span>

        <span class="c1"># populate the index field of nodes. This is a redundancy, so we don&#39;t expect this field</span>
        <span class="c1"># to be serialized/deserialized</span>
        <span class="k">for</span> <span class="n">nodei</span><span class="p">,</span> <span class="n">nodedata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">nodedata</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nodei</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="NetworkSchema.post_load"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.NetworkSchema.post_load">[docs]</a>    <span class="nd">@post_load</span>
    <span class="k">def</span> <span class="nf">post_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TNetwork</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TNetwork</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="NetworkSchema.post_dump"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.NetworkSchema.post_dump">[docs]</a>    <span class="nd">@post_dump</span>
    <span class="k">def</span> <span class="nf">post_dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;serialVersion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SERIAL_VERSION</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<span class="n">net_schema</span> <span class="o">=</span> <span class="n">NetworkSchema</span><span class="p">()</span>


<div class="viewcode-block" id="dumpNetwork"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.dumpNetwork">[docs]</a><span class="k">def</span> <span class="nf">dumpNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dump the network into an object and return it.&quot;&quot;&quot;</span>
    <span class="c1"># TODO don&#39;t construct NetworkSchema every time.</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">_getNetwork</span><span class="p">(</span><span class="n">neti</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net_schema</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">net</span><span class="p">)</span></div>


<div class="viewcode-block" id="loadNetwork"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.loadNetwork">[docs]</a><span class="k">def</span> <span class="nf">loadNetwork</span><span class="p">(</span><span class="n">net_object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load the network object (laoded directly from JSON) and add it, returning the network index.</span>

<span class="sd">    Note:</span>
<span class="sd">        For now this overwrites the network at index 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTE marshmallow::load does not guarantee that the input object is not modified. Therefore,</span>
    <span class="c1"># we need to make a deepcopy</span>
    <span class="n">obj_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">net_object</span><span class="p">)</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">net_schema</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">obj_copy</span><span class="p">)</span>
    <span class="n">clearNetworks</span><span class="p">()</span>
    <span class="n">_addNetwork</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="validateState"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.validateState">[docs]</a><span class="k">def</span> <span class="nf">validateState</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">undoStack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">redoStack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="n">net_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">net</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">net_ids</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">net_ids</span><span class="p">)),</span> <span class="s2">&quot;duplicate network IDs&quot;</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">networkDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">neti</span><span class="p">,</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">networkDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">neti</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">TNetwork</span><span class="p">)</span>

        <span class="n">validateNodes</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span></div>
        <span class="c1"># TODO validate reactions, compartments, and cross-validate</span>


<div class="viewcode-block" id="validateNodes"><a class="viewcode-back" href="../../rkviewer/rkviewer.html#rkviewer.iodine.validateNodes">[docs]</a><span class="k">def</span> <span class="nf">validateNodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">TAbstractNode</span><span class="p">]):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">nodei</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodei</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">),</span> <span class="s1">&#39;unexpected type: &#39;</span> <span class="o">+</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="n">cnodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">TNode</span><span class="p">)]</span>
    <span class="n">aliases</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">TAliasNode</span><span class="p">)]</span>

    <span class="n">node_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">cnodes</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)),</span> <span class="s2">&quot;duplicate node IDs&quot;</span>

    <span class="c1"># assert alias references are good</span>
    <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">aliases</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias</span><span class="o">.</span><span class="n">originalIdx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">alias</span><span class="o">.</span><span class="n">originalIdx</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="n">alias</span><span class="o">.</span><span class="n">originalIdx</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">alias</span><span class="o">.</span><span class="n">originalIdx</span><span class="p">],</span> <span class="n">TNode</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">cnode</span> <span class="ow">in</span> <span class="n">cnodes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cnode</span><span class="o">.</span><span class="n">floating</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">node</span><span class="p">:</span> <span class="n">TAbstractNode</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">nodeLocked</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">compi</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">Vec2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">rectSize</span><span class="p">,</span> <span class="n">Vec2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">rectSize</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span></div>
        <span class="c1"># TODO assert node.compi in net.compartments OUTSIDE of this function</span>

    <span class="c1"># TODO assert more properties</span>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, Jin Xu, Gary Geng, Nhan D. Nguyen, Carmen Perena-Cortes, Claire Samuels, Herbert M. Sauro

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>